name: Java CI with Gradle  # ???????? ?????? workflow

on:  # ??????????, ????? ????? ??????????? workflow
  push:
    branches: [ main, feature/* ]  # ??? push ? ????? main ??? ????? feature-?????
  pull_request:
    branches: [ main ]  # ??? ???????? PR ? main

jobs:  # ??????, ??????? ????? ???????????
  build:  # ???????? ??????
    runs-on: ubuntu-latest  # ?? ????? ?? ????? ??????????? (???????? alpine ?? ubuntu)

    steps:  # ???? ??????????
      - uses: actions/checkout@v3  # ???????????? ???????????

      - name: Set up JDK 21  # ????????? Java 21
        uses: actions/setup-java@v3
        with:
          java-version: '21'
          distribution: 'temurin'

      - name: Prepare  # ?????????? ?????????????? ???? ?? ??????????
        run: chmod +x gradlew

      - name: Build without tests  # ?????? ??????? ??? ??????
        run: ./gradlew clean build -x test

      - name: Run tests  # ?????? ??????
        run: ./gradlew test

      - name: Clean and build  # ??????? ? ?????? ?????? ???????
        run: ./gradlew clean build